<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hawli.cn","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="早告别青春，活成了别人">
<meta property="og:type" content="website">
<meta property="og:title" content="李科燃的主页">
<meta property="og:url" content="https://hawli.cn/index.html">
<meta property="og:site_name" content="李科燃的主页">
<meta property="og:description" content="早告别青春，活成了别人">
<meta property="og:locale">
<meta property="article:author" content="李科燃">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://hawli.cn/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>李科燃的主页</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">李科燃的主页</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">想说却还没说的</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2020/12/13/Raft%E4%BB%8B%E7%BB%8D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2020/12/13/Raft%E4%BB%8B%E7%BB%8D/" class="post-title-link" itemprop="url">mit-6.824-Lab2(最后更新时间2020/12/13)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2020-12-13 14:49:00 / Modified: 15:34:41" itemprop="dateCreated datePublished" datetime="2020-12-13T14:49:00+08:00">2020-12-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/mit6-824/" itemprop="url" rel="index"><span itemprop="name">mit6.824</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2020/12/13/Raft%E4%BB%8B%E7%BB%8D/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2020/12/13/Raft%E4%BB%8B%E7%BB%8D/" class="cy_cmt_count" data-xid="2020/12/13/Raft介绍/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>mit 6.824是一个很好的学习分布式的项目<br>Lab2 是一个raft项目。</p>
<h3 id="相关资料"><a href="#相关资料" class="headerlink" title="相关资料"></a>相关资料</h3><ul>
<li><a href="%22https://pdos.csail.mit.edu/6.824/%22">项目主页</a></li>
<li><a href="%22https://pdos.csail.mit.edu/6.824/labs/lab-raft.html%22">Lab2</a></li>
<li><a href="%22https://pdos.csail.mit.edu/6.824/papers/raft-extended.pdf%22">论文地址</a></li>
<li><a href="%22https://www.infoq.cn/article/raft-paper%22">中文翻译</a></li>
</ul>
<blockquote>
<p>介绍<br><br>这是一系列实验中的第一个，你将在其中构建容错的键/值存储系统。在本实验中，你将实现Raft（复制状态机协议）。在下一个实验中，你将在Raft之上构建键/值服务。然后，你将在多个复制的状态机上“分片”服务，以提高性能。<br><br>复制服务通过将其状态（即数据）的完整副本存储在多个副本服务器上来实现容错功能。即使服务的某些服务器出现故障（崩溃，网络故障或不稳定），复制也可以使服务继续运行。挑战在于，故障可能导致副本持有不同的数据副本。<br><br><br>Raft将客户请求组织成一个序列，称为日志，并确保所有副本服务器看到相同的日志。每个副本都以日志顺序执行客户端请求，并将其应用于服务状态的本地副本。由于所有活动复本都看到相同的日志内容，因此它们都以相同的顺序执行相同的请求，因此继续具有相同的服务状态。如果服务器出现故障但后来又恢复了，Raft会确保其日志为最新状态。只要至少大多数服务器都处于活动状态并且可以相互通信，筏将继续运行。如果没有这样的多数，Raft将不会取得进展，但是一旦多数能够再次交流，它将从停下来的地方继续前进。<br><br><br>在本实验中，你将通过关联的方法将Raft实现为Go对象类型，该方法旨在用作更大服务中的模块。一组Raft实例与RPC相互通信以维护复制的日志。你的Raft界面将支持不定编号的命令序列，也称为日志条目。这些条目已用索引号编号。具有给定索引的日志条目最终将被提交。届时，你的Raft应该将日志条目发送到较大的服务，以便其执行。<br><br><br>你应该遵循扩展的Raft论文中的设计，尤其要注意图2。你将实现论文中的大部分内容，包括保存持久状态并在节点出现故障后重新读取它。你将不会实现集群成员资格更改（第6节）。你将在以后的实验中实现日志压缩/快照化（第7节）。<br><br><br>你可能会发现本指南很有用，以及有关锁定和并发结构的建议。从更广泛的角度来看，请查看Paxos，Chubby，Paxos Made Live，Spanner，Zookeeper，Harp，Viewstamped Replication和Bolosky等。<br><br><br>该实验分为三个部分。你必须在相应的截止日期之前提交每个零件。</p>
</blockquote>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/13/Go-%E8%AF%AD%E8%A8%80-struct%E8%BD%ACmap%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/13/Go-%E8%AF%AD%E8%A8%80-struct%E8%BD%ACmap%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/" class="post-title-link" itemprop="url">Go 语言 struct转map的三种方法</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-13 14:42:00" itemprop="dateCreated datePublished" datetime="2018-04-13T14:42:00+08:00">2018-04-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/13/Go-%E8%AF%AD%E8%A8%80-struct%E8%BD%ACmap%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/13/Go-%E8%AF%AD%E8%A8%80-struct%E8%BD%ACmap%E7%9A%84%E4%B8%89%E7%A7%8D%E6%96%B9%E6%B3%95/" class="cy_cmt_count" data-xid="2018/04/13/Go-语言-struct转map的三种方法/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>注意struct 里面的字段首字母要大写，否则是出不来的。</p>
<p>第一种方式是利用json。我比较喜欢。</p>
<p><strong>josn</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;encoding/json&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ToMap</span><span class="params">(in2 <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">map</span>[<span class="title">string</span>]<span class="title">interface</span></span>&#123;&#125; &#123;</span><br><span class="line">	m := <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	inrec, _ := json.Marshal(in2)</span><br><span class="line">	json.Unmarshal(inrec, &amp;m)</span><br><span class="line">	<span class="keyword">return</span> m</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>第二种方式是利用反射<br><strong>reflect</strong></p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">Struct2Map</span><span class="params">(obj <span class="keyword">interface</span>&#123;&#125;)</span> <span class="title">map</span>[<span class="title">string</span>]<span class="title">interface</span></span>&#123;&#125; &#123;</span><br><span class="line">	t := reflect.TypeOf(obj)</span><br><span class="line">	v := reflect.ValueOf(obj)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">var</span> data = <span class="built_in">make</span>(<span class="keyword">map</span>[<span class="keyword">string</span>]<span class="keyword">interface</span>&#123;&#125;)</span><br><span class="line">	<span class="keyword">for</span> i := <span class="number">0</span>; i &lt; t.NumField(); i++ &#123;</span><br><span class="line">		data[t.Field(i).Name] = v.Field(i).Interface()</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> data</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>第三种方法是利用第三方的库，最简单。</p>
<p><strong>github.com/fatih/structs</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">m :&#x3D; structs.Map(structs)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/09/swag%E6%B3%A8%E8%A7%A3%E6%8C%87%E5%8D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/09/swag%E6%B3%A8%E8%A7%A3%E6%8C%87%E5%8D%97/" class="post-title-link" itemprop="url">swag注解指南(gin 使用swagger生成文档)</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-09 17:10:00" itemprop="dateCreated datePublished" datetime="2018-04-09T17:10:00+08:00">2018-04-09</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/09/swag%E6%B3%A8%E8%A7%A3%E6%8C%87%E5%8D%97/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/09/swag%E6%B3%A8%E8%A7%A3%E6%8C%87%E5%8D%97/" class="cy_cmt_count" data-xid="2018/04/09/swag注解指南/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>如果想要为gin 配置swagger ，会需要用到这样一个库<a target="_blank" rel="noopener" href="https://github.com/swaggo/swag">swag</a>，具体怎么配置我就不在这篇写了。</p>
<p>这篇主要讲注解怎么写。配置好框架之后，你会需要写一堆注解，好让swag知道怎么生成文档.</p>
<p>由于官方的例子比较凌乱，对于没接触过的人，我觉得会造成一些困扰。所以特意整理一下，发出来。希望能帮助到需要的人。</p>
<h1 id="API-操作"><a href="#API-操作" class="headerlink" title="API 操作"></a>API 操作</h1><table>
<thead>
<tr>
<th>注解</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>description</td>
<td>描述，操作行为的详细解释</td>
</tr>
<tr>
<td>id</td>
<td>ID，用于识别操作的唯一字符串。在所有API操作中必须是唯一的。</td>
</tr>
<tr>
<td>tags</td>
<td>标签，A list of tags to each API operation that separated by commas.</td>
</tr>
<tr>
<td>summary</td>
<td>概要，A short summary of what the operation does.</td>
</tr>
<tr>
<td>accept</td>
<td>API可以使用的MIME类型列表。值必须如[MIME类型](#Mime 类型)所述。</td>
</tr>
<tr>
<td>produce</td>
<td>API可以生成的MIME类型列表。值必须如[MIME类型](#Mime 类型)所述。</td>
</tr>
<tr>
<td>param</td>
<td>参数, 以空格分隔的参数 <code>param name</code>,<code>param type</code>,<code>data type</code>,<code>is mandatory?</code>,<code>comment</code> <code>attribute(optional)</code></td>
</tr>
<tr>
<td>security</td>
<td><a href="#%E5%AE%89%E5%85%A8">安全性</a></td>
</tr>
<tr>
<td>success</td>
<td>以空格分隔的成功响应。 <code>return code</code>,<code>&#123;param type&#125;</code>,<code>data type</code>,<code>comment</code></td>
</tr>
<tr>
<td>failure</td>
<td>以空格分隔的失败响应。 <code>return code</code>,<code>&#123;param type&#125;</code>,<code>data type</code>,<code>comment</code></td>
</tr>
<tr>
<td>router</td>
<td>访问路径。 <code>path</code>,<code>[httpMethod]</code></td>
</tr>
</tbody></table>
<h2 id="例子"><a href="#例子" class="headerlink" title="例子"></a>例子</h2><p><a target="_blank" rel="noopener" href="https://github.com/swaggo/swag/tree/master/example/celler/controller">celler/controller</a></p>
<h2 id="局限性"><a href="#局限性" class="headerlink" title="局限性"></a>局限性</h2><ul>
<li>不支持跨包装模型。只在项目根文件夹中搜索。 <a target="_blank" rel="noopener" href="https://github.com/swaggo/swag/issues/39">见 #39</a></li>
</ul>
<h2 id="Mime-类型"><a href="#Mime-类型" class="headerlink" title="Mime 类型"></a>Mime 类型</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">json</span><br><span class="line">application&#x2F;json</span><br><span class="line">xml</span><br><span class="line">text&#x2F;xml</span><br><span class="line">plain</span><br><span class="line">text&#x2F;plain</span><br><span class="line">html</span><br><span class="line">text&#x2F;html</span><br><span class="line">mpfd</span><br><span class="line">multipart&#x2F;form-data</span><br><span class="line">json-api</span><br><span class="line">application&#x2F;vnd.api+json</span><br></pre></td></tr></table></figure>

<h2 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h2><p>一般API信息</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @securityDefinitions.basic BasicAuth</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// @securitydefinitions.oauth2.application OAuth2Application</span></span><br><span class="line"><span class="comment">// @tokenUrl https://example.com/oauth/token</span></span><br><span class="line"><span class="comment">// @scope.write Grants write access</span></span><br><span class="line"><span class="comment">// @scope.admin Grants read and write access to administrative information</span></span><br></pre></td></tr></table></figure>

<p>每个API操作</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @Security ApiKeyAuth</span></span><br></pre></td></tr></table></figure>

<p>创建和条件</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @Security ApiKeyAuth</span></span><br><span class="line"><span class="comment">// @Security OAuth2Application[write, admin]</span></span><br></pre></td></tr></table></figure>

<h2 id="参数类型"><a href="#参数类型" class="headerlink" title="参数类型"></a>参数类型</h2><ul>
<li>object (struct)</li>
<li>string (string)</li>
<li>integer (int, uint, uint32, uint64)</li>
<li>number (float32)</li>
<li>boolean (bool)</li>
<li>array</li>
</ul>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><ul>
<li>string (string)</li>
<li>integer (int, uint, uint32, uint64)</li>
<li>number (float32)</li>
<li>boolean (bool)</li>
<li>user defined struct</li>
</ul>
<h2 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h2><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @Param enumstring查询字符串false“字符串枚举”枚举（A，B，C）</span></span><br><span class="line"><span class="comment">// @Param enumint查询int int“int enums”枚举（1，2，3）</span></span><br><span class="line"><span class="comment">// @Param枚举查询编号false“int枚举“枚举（1.1,1.2,1.3）</span></span><br><span class="line"><span class="comment">// @Param字符串查询字符串假”字符串有效“minlength（5）maxlength（10）</span></span><br><span class="line"><span class="comment">// @Param int查询int假”int valid“mininum（1）maxinum（10）</span></span><br><span class="line"><span class="comment">// @Param默认查询字符串false“字符串默认”默认（A）</span></span><br></pre></td></tr></table></figure>

<h3 id="可以得到"><a href="#可以得到" class="headerlink" title="可以得到"></a>可以得到</h3><table>
<thead>
<tr>
<th>字段名</th>
<th align="center">类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><a name="parameterDefault"></a>default</td>
<td align="center">*</td>
<td>Declares the value of the parameter that the server will use if none is provided, for example a “count” to control the number of results per page might default to 100 if not supplied by the client in the request. (Note: “default” has no meaning for required parameters.)  See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-6.2">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-6.2</a>. Unlike JSON Schema this value MUST conform to the defined <a href="#parameterType"><code>type</code></a> for this parameter.</td>
</tr>
<tr>
<td><a name="parameterMaximum"></a>maximum</td>
<td align="center"><code>number</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.1.2">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.1.2</a>.</td>
</tr>
<tr>
<td><a name="parameterMinimum"></a>minimum</td>
<td align="center"><code>number</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.1.3">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.1.3</a>.</td>
</tr>
<tr>
<td><a name="parameterMaxLength"></a>maxLength</td>
<td align="center"><code>integer</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.2.1">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.2.1</a>.</td>
</tr>
<tr>
<td><a name="parameterMinLength"></a>minLength</td>
<td align="center"><code>integer</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.2.2">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.2.2</a>.</td>
</tr>
<tr>
<td><a name="parameterEnums"></a>enums</td>
<td align="center">[*]</td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.5.1">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.5.1</a>.</td>
</tr>
</tbody></table>
<h3 id="功能"><a href="#功能" class="headerlink" title="功能"></a>功能</h3><table>
<thead>
<tr>
<th>字段名</th>
<th align="center">类型</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><a name="parameterFormat"></a>format</td>
<td align="center"><code>string</code></td>
<td>The extending format for the previously mentioned <a href="#parameterType"><code>type</code></a>. See <a href="#dataTypeFormat">Data Type Formats</a> for further details.</td>
</tr>
<tr>
<td><a name="parameterMultipleOf"></a>multipleOf</td>
<td align="center"><code>number</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.1.1">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.1.1</a>.</td>
</tr>
<tr>
<td><a name="parameterPattern"></a>pattern</td>
<td align="center"><code>string</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.2.3">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.2.3</a>.</td>
</tr>
<tr>
<td><a name="parameterMaxItems"></a>maxItems</td>
<td align="center"><code>integer</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.3.2">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.3.2</a>.</td>
</tr>
<tr>
<td><a name="parameterMinItems"></a>minItems</td>
<td align="center"><code>integer</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.3.3">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.3.3</a>.</td>
</tr>
<tr>
<td><a name="parameterUniqueItems"></a>uniqueItems</td>
<td align="center"><code>boolean</code></td>
<td>See <a target="_blank" rel="noopener" href="https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.3.4">https://tools.ietf.org/html/draft-fge-json-schema-validation-00#section-5.3.4</a>.</td>
</tr>
<tr>
<td><a name="parameterCollectionFormat"></a>collectionFormat</td>
<td align="center"><code>string</code></td>
<td>Determines the format of the array if type array is used. Possible values are: <ul><li><code>csv</code> - comma separated values <code>foo,bar</code>. <li><code>ssv</code> - space separated values <code>foo bar</code>. <li><code>tsv</code> - tab separated values <code>foo\tbar</code>. <li><code>pipes</code> - pipe separated values <code>foo&#124;bar</code>. <li><code>multi</code> - corresponds to multiple parameter instances instead of multiple values for a single instance <code>foo=bar&amp;foo=baz</code>. This is valid only for parameters <a href="#parameterIn"><code>in</code></a> “query” or “formData”. </ul> Default value is <code>csv</code>.</td>
</tr>
</tbody></table>
<h2 id="提示"><a href="#提示" class="headerlink" title="提示"></a>提示</h2><h3 id="具有数组类型的用户定义结构"><a href="#具有数组类型的用户定义结构" class="headerlink" title="具有数组类型的用户定义结构"></a>具有数组类型的用户定义结构</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// @Success 200 &#123;array&#125; model.Account &lt;-- This is a user defined struct.</span></span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> model</span><br><span class="line"></span><br><span class="line"><span class="keyword">type</span> Account <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID   <span class="keyword">int</span>    <span class="string">`json:&quot;id&quot; example:&quot;1&quot;`</span></span><br><span class="line">    Name <span class="keyword">string</span> <span class="string">`json:&quot;name&quot; example:&quot;account name&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="使用多个路径参数"><a href="#使用多个路径参数" class="headerlink" title="使用多个路径参数"></a>使用多个路径参数</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/// ...</span></span><br><span class="line"><span class="comment">// @Param group_id path int true &quot;Group ID&quot;</span></span><br><span class="line"><span class="comment">// @Param account_id path int true &quot;Account ID&quot;</span></span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line"><span class="comment">// @Router /examples/groups/&#123;group_id&#125;/accounts/&#123;account_id&#125; [get]</span></span><br></pre></td></tr></table></figure>

<h3 id="结构体的例子"><a href="#结构体的例子" class="headerlink" title="结构体的例子"></a>结构体的例子</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">type</span> Account <span class="keyword">struct</span> &#123;</span><br><span class="line">    ID   <span class="keyword">int</span>    <span class="string">`json:&quot;id&quot; example:&quot;1&quot;`</span></span><br><span class="line">    Name <span class="keyword">string</span> <span class="string">`json:&quot;name&quot; example:&quot;account name&quot;`</span></span><br><span class="line">    PhotoUrls []<span class="keyword">string</span> <span class="string">`json:&quot;photo_urls&quot; example:&quot;http://test/image/1.jpg,http://test/image/2.jpg&quot;`</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-03-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-03-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">设计模式(03)-单例模式-Python实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 17:40:00" itemprop="dateCreated datePublished" datetime="2018-04-03T17:40:00+08:00">2018-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-03-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-03-%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/" class="cy_cmt_count" data-xid="2018/04/03/设计模式-03-单例模式-Python实现/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="单例模式比较简单，就不多说了"><a href="#单例模式比较简单，就不多说了" class="headerlink" title="单例模式比较简单，就不多说了"></a>单例模式比较简单，就不多说了</h4><p><a target="_blank" rel="noopener" href="https://github.com/hawkli-1994/implementation-design-pattern/blob/master/singleton.py">github</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">单例模式</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">意图：保证一个类仅有一个实例，并提供一个访问它的全局访问点。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">主要解决：一个全局使用的类频繁地创建与销毁。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">何时使用：当您想控制实例数目，节省系统资源的时候。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">如何解决：判断系统是否已经有这个单例，如果有则返回，如果没有则创建。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">关键代码：构造函数是私有的。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Singleton</span>(<span class="params"><span class="built_in">type</span></span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        self.__instance = <span class="literal">None</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__call__</span>(<span class="params">self, *args, **kwargs</span>):</span></span><br><span class="line">        <span class="keyword">if</span> self.__instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            self.__instance = <span class="built_in">super</span>().__call__(*args, **kwargs)</span><br><span class="line">            <span class="keyword">return</span> self.__instance</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.__instance</span><br><span class="line"></span><br><span class="line"><span class="comment"># Example</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Spam</span>(<span class="params">metaclass=Singleton</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&#x27;Creating Spam&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    a = Spam()</span><br><span class="line">    b = Spam()</span><br><span class="line">    a <span class="keyword">is</span> b</span><br><span class="line">    c = Spam()</span><br><span class="line">    c <span class="keyword">is</span> a</span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-02-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-02-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">设计模式(02)-抽象工厂模式-Python实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 17:38:00" itemprop="dateCreated datePublished" datetime="2018-04-03T17:38:00+08:00">2018-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-02-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-02-%E6%8A%BD%E8%B1%A1%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/" class="cy_cmt_count" data-xid="2018/04/03/设计模式-02-抽象工厂模式-Python实现/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="ok，继续上篇，由于时间仓促，这里目前只贴出代码，详解我后续会更新。"><a href="#ok，继续上篇，由于时间仓促，这里目前只贴出代码，详解我后续会更新。" class="headerlink" title="ok，继续上篇，由于时间仓促，这里目前只贴出代码，详解我后续会更新。"></a>ok，继续上篇，由于时间仓促，这里目前只贴出代码，详解我后续会更新。</h4><p><a target="_blank" rel="noopener" href="https://github.com/hawkli-1994/implementation-design-pattern">github</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">抽象工厂模式（Abstract Factory Pattern）是围绕一个超级工厂创建其他工厂。该超级工厂又称为其他工厂的工厂。这种类型的设计模式属于创建型模式，它提供了一种创建对象的最佳方式。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">在抽象工厂模式中，接口是负责创建一个相关对象的工厂，不需要显式指定它们的类。每个生成的工厂都能按照工厂模式提供对象。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">所以这里给KFC增加一个产品族，鸡肉卷.就变成，汉堡和鸡肉卷两种产品了</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> abc <span class="keyword">import</span> ABCMeta, abstractmethod</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AbsFood</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;可以认为鸡肉卷和汉堡都是食物，共用一个基类&quot;&quot;&quot;</span></span><br><span class="line">    __metaclass__ = ABCMeta</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">taste</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;味道&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;名字&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AbsFoodFactory</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;一个抽象的工厂，作为基类&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    __metaclass__ = ABCMeta</span><br><span class="line"></span><br><span class="line"><span class="meta">    @abstractmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_food</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hamburger</span>(<span class="params">AbsFood</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;汉堡&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, material</span>):</span></span><br><span class="line">        self.material = <span class="built_in">str</span>(material)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">taste</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&quot;like shit&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&quot;&#123;&#125; Hamburger&quot;</span>.<span class="built_in">format</span>(self.material))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChickenRoll</span>(<span class="params">AbsFood</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;鸡肉卷&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, material</span>):</span></span><br><span class="line">        self.material = <span class="built_in">str</span>(material)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">taste</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&quot;like Chicken&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">name</span>(<span class="params">self</span>):</span></span><br><span class="line">        print(<span class="string">&quot;&#123;&#125; Chicken roll&quot;</span>.<span class="built_in">format</span>(self.material))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">HamburgerFactory</span>(<span class="params">AbsFoodFactory</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;汉堡工厂&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, material</span>):</span></span><br><span class="line">        self.material = material</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_food</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Hamburger(self.material)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ChickenRollFactory</span>(<span class="params">AbsFoodFactory</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;鸡肉卷工厂&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, material</span>):</span></span><br><span class="line">        self.material = material</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_food</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> ChickenRoll(self.material)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KFC</span>:</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_food_factory</span>(<span class="params">factory_name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> factory_name == <span class="string">&#x27;hamburger&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> HamburgerFactory<span class="comment">#(material)</span></span><br><span class="line">        <span class="keyword">elif</span> factory_name == <span class="string">&#x27;chickenroll&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> ChickenRollFactory<span class="comment">#(material)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    hamburger_factory = KFC.get_food_factory(<span class="string">&quot;hamburger&quot;</span>)</span><br><span class="line">    hamburger = hamburger_factory(<span class="string">&quot;fruit&quot;</span>).get_food()</span><br><span class="line">    hamburger.name()</span><br><span class="line">    hamburger.taste()</span><br><span class="line"></span><br><span class="line">    chickenroll_factory = KFC.get_food_factory(<span class="string">&quot;chickenroll&quot;</span>)</span><br><span class="line">    chickenroll = chickenroll_factory(<span class="string">&quot;chicken&quot;</span>).get_food()</span><br><span class="line">    chickenroll.taste()</span><br><span class="line">    chickenroll.name()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-01-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-01-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/" class="post-title-link" itemprop="url">设计模式(01)-简单工厂模式-Python实现</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 17:37:00" itemprop="dateCreated datePublished" datetime="2018-04-03T17:37:00+08:00">2018-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F/" itemprop="url" rel="index"><span itemprop="name">设计模式</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-01-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/03/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F-01-%E7%AE%80%E5%8D%95%E5%B7%A5%E5%8E%82%E6%A8%A1%E5%BC%8F-Python%E5%AE%9E%E7%8E%B0/" class="cy_cmt_count" data-xid="2018/04/03/设计模式-01-简单工厂模式-Python实现/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>####最近有一个计划，就是把23种设计模式都实现一遍，弥补一下在这方面的短板。只会curd的程序员不是有梦想的咸鱼。<br><a target="_blank" rel="noopener" href="https://github.com/hawkli-1994/implementation-design-pattern/blob/master/factory_model.py">先贴代码</a>：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">简单工厂模式</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">实现一个肯德基类</span></span><br><span class="line"><span class="string">可以生产汉堡</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Foodstuff</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;食材&quot;&quot;&quot;</span></span><br><span class="line">    vegetables = <span class="string">&#x27;vegetables&#x27;</span>  <span class="comment"># 蔬菜</span></span><br><span class="line">    meat = <span class="string">&#x27;meat&#x27;</span>  <span class="comment"># 肉</span></span><br><span class="line">    fruits = <span class="string">&#x27;fruits&#x27;</span>  <span class="comment"># 水果</span></span><br><span class="line">    eggs = <span class="string">&#x27;eggs&#x27;</span>  <span class="comment"># 鸡蛋</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hamburger</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;汉堡对象&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span>(<span class="params">self, *args</span>):</span></span><br><span class="line">        j = <span class="string">&quot;&quot;</span>.join([i + <span class="string">&#x27; &#x27;</span> <span class="keyword">for</span> i <span class="keyword">in</span> args])</span><br><span class="line">        self.name = <span class="string">&quot;this is a &#123;&#125; hamburger&quot;</span>.<span class="built_in">format</span>(j)</span><br><span class="line">        print(<span class="string">&quot;Make a &#123;&#125; burger&quot;</span>.<span class="built_in">format</span>(j))</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__str__</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">VegetablesMeat</span>(<span class="params">Foodstuff</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;蔬菜水果汉堡&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_hamburger</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Hamburger(self.vegetables, self.fruits)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FruitsEggs</span>(<span class="params">Foodstuff</span>):</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;水果鸡蛋汉堡&quot;&quot;&quot;</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_hamburger</span>(<span class="params">self</span>):</span></span><br><span class="line">        <span class="keyword">return</span> Hamburger(self.fruits, self.eggs)</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">KFCFactory</span>:</span></span><br><span class="line">    <span class="string">&quot;&quot;&quot;汉堡工厂&quot;&quot;&quot;</span></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">buy_hamburger</span>(<span class="params">hamburger_name</span>):</span></span><br><span class="line">        <span class="keyword">if</span> hamburger_name == <span class="string">&#x27;vegetables fruits&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> VegetablesMeat()</span><br><span class="line">        <span class="keyword">elif</span> hamburger_name == <span class="string">&#x27;fruits eggs&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> FruitsEggs()</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> VegetablesMeat()</span><br><span class="line">        </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    vegetables_fruits = KFCFactory.buy_hamburger(<span class="string">&#x27;vegetables fruits&#x27;</span>).get_hamburger()</span><br><span class="line">    fruits_eggs = KFCFactory.buy_hamburger(<span class="string">&#x27;fruits eggs&#x27;</span>).get_hamburger()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-03-%E4%BD%BF%E7%94%A8Redis/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-03-%E4%BD%BF%E7%94%A8Redis/" class="post-title-link" itemprop="url">Gin 系列教程 (03)-使用Redis</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 16:58:00" itemprop="dateCreated datePublished" datetime="2018-04-03T16:58:00+08:00">2018-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-03-%E4%BD%BF%E7%94%A8Redis/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-03-%E4%BD%BF%E7%94%A8Redis/" class="cy_cmt_count" data-xid="2018/04/03/Gin-系列教程-03-使用Redis/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>利用Redis做一些缓存和存储来提高网站性能，是每个普通人都知道的常识。所以，这里介绍一下Go语言开发的应用如何使用Redis。</p>
<p>首先，选择一个驱动</p>
<h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get <span class="string">&quot;github.com/go-redis/redis&quot;</span></span><br></pre></td></tr></table></figure>
<h3 id="Quickstart"><a href="#Quickstart" class="headerlink" title="Quickstart"></a>Quickstart</h3><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/go-redis/redis&quot;</span></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleNewClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">	client := redis.NewClient(&amp;redis.Options&#123;</span><br><span class="line">		Addr:     <span class="string">&quot;localhost:6379&quot;</span>,</span><br><span class="line">		Password: <span class="string">&quot;&quot;</span>, <span class="comment">// no password set</span></span><br><span class="line">		DB:       <span class="number">0</span>,  <span class="comment">// use default DB</span></span><br><span class="line">	&#125;)</span><br><span class="line"></span><br><span class="line">	pong, err := client.Ping().Result()</span><br><span class="line">	fmt.Println(pong, err)</span><br><span class="line">	<span class="comment">// Output: PONG &lt;nil&gt;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">ExampleClient</span><span class="params">()</span></span> &#123;</span><br><span class="line">	err := client.Set(<span class="string">&quot;key&quot;</span>, <span class="string">&quot;value&quot;</span>, <span class="number">0</span>).Err()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	val, err := client.Get(<span class="string">&quot;key&quot;</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125;</span><br><span class="line">	fmt.Println(<span class="string">&quot;key&quot;</span>, val)</span><br><span class="line"></span><br><span class="line">	val2, err := client.Get(<span class="string">&quot;key2&quot;</span>).Result()</span><br><span class="line">	<span class="keyword">if</span> err == redis.Nil &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;key2 does not exist&quot;</span>)</span><br><span class="line">	&#125; <span class="keyword">else</span> <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">		<span class="built_in">panic</span>(err)</span><br><span class="line">	&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">		fmt.Println(<span class="string">&quot;key2&quot;</span>, val2)</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="comment">// Output: key value</span></span><br><span class="line">	<span class="comment">// key2 does not exist</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>实际上你用client对象执行redis的命令都是可以的，比如hget, hset等等。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-02-%E4%BD%BF%E7%94%A8MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-02-%E4%BD%BF%E7%94%A8MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-title-link" itemprop="url">Gin 系列教程 (02)-使用MySQL数据库</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-03 09:51:00" itemprop="dateCreated datePublished" datetime="2018-04-03T09:51:00+08:00">2018-04-03</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-02-%E4%BD%BF%E7%94%A8MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/03/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-02-%E4%BD%BF%E7%94%A8MySQL%E6%95%B0%E6%8D%AE%E5%BA%93/" class="cy_cmt_count" data-xid="2018/04/03/Gin-系列教程-02-使用MySQL数据库/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一般来说，一个web应用肯定是离不开数据库的。通过对数据库的增删改查，足以胜任相当一部分应用场景了。<br>这里会介绍最基本的连接数据库和几个增删改查的例子。</p>
<h3 id="驱动"><a href="#驱动" class="headerlink" title="驱动"></a>驱动</h3><p>mysql的驱动我使用github.com/go-sql-driver/mysql</p>
<figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get -u github.com/go-sql-driver/mysql</span><br></pre></td></tr></table></figure>

<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;database/sql&quot;</span></span><br><span class="line"><span class="keyword">import</span> _ <span class="string">&quot;github.com/go-sql-driver/mysql&quot;</span></span><br><span class="line"></span><br><span class="line">db, err := sql.Open(<span class="string">&quot;mysql&quot;</span>, <span class="string">&quot;user:password@/dbname&quot;</span>)</span><br></pre></td></tr></table></figure>
<h4 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h4><p>初始化链接参数的时候，除了dbname，其他参数都是选填的，比如数据库没有密码，就可以不填。<br>比如最短的情况下可以是</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;dbname</span><br></pre></td></tr></table></figure>
<p>如果你不想预先选择数据库，甚至可以：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x2F;</span><br></pre></td></tr></table></figure>
<h4 id="密码"><a href="#密码" class="headerlink" title="密码"></a>密码</h4><p>密码支持任何字符，所以也不需要转义</p>
<h4 id="协议"><a href="#协议" class="headerlink" title="协议"></a>协议</h4><p>一般情况下可以选择unix 套接字或者是tcp。</p>
<h4 id="地址"><a href="#地址" class="headerlink" title="地址"></a>地址</h4><p>对于tcp和udp连接类型，使用host[: port]这种格式，如果不填port，则会使用默认端口3306，如果host是ipv6类型，必须用方括号括起来，函数net.JoinHostPort和net.SplitHostPort以这种形式处理地址。</p>
<p>对于Unix 套接字，地址是MySQL服务器套接字的绝对路径，例如/var/run/mysqld/mysqld.sock或/tmp/mysql.sock。</p>
<h4 id="参数-1"><a href="#参数-1" class="headerlink" title="参数"></a>参数</h4><p>参数是区分大小写的！<br>这部分内容比较多，且不常用，本篇文章的重点不在于介绍这个mysql库，所以就不再赘述。</p>
<h4 id="用法"><a href="#用法" class="headerlink" title="用法"></a>用法</h4><p>这里简单介绍一下增删改查等常见用法。<br>首先，假设我们有一个数据库，test01，有一张数据表 user。</p>
<p>表结构：</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="keyword">user</span> (</span><br><span class="line">	<span class="keyword">id</span> <span class="built_in">INT</span>(<span class="number">10</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT,</span><br><span class="line">	username <span class="built_in">varchar</span>(<span class="number">10</span>) <span class="keyword">not</span> <span class="literal">null</span>,</span><br><span class="line">    pw <span class="built_in">varchar</span>(<span class="number">20</span>) <span class="keyword">not</span> <span class="literal">null</span></span><br><span class="line">);</span><br></pre></td></tr></table></figure>
<h4 id="增删改查例子"><a href="#增删改查例子" class="headerlink" title="增删改查例子"></a>增删改查例子</h4><figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;database/sql&quot;</span></span><br><span class="line"><span class="keyword">import</span> _ <span class="string">&quot;github.com/go-sql-driver/mysql&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">  db, err := sql.Open(<span class="string">&quot;mysql&quot;</span>, <span class="string">&quot;user:password@/dbname&quot;</span>)</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="built_in">panic</span>(err.Error())</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">defer</span> db.Close()</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 打开关闭的链接，验证配置</span></span><br><span class="line">  err = db.Ping()</span><br><span class="line">  <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">      <span class="built_in">panic</span>(err.Error()) <span class="comment">//进行错误处理</span></span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// 插入数据</span></span><br><span class="line">stmtIns, err := db.Prepare(<span class="string">&quot;insert into user values( ?, ? )&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> stmtIns.Close()</span><br><span class="line"><span class="comment">//查询数据</span></span><br><span class="line">stmtOut, err := db.Prepare(<span class="string">&quot;select username from user where id = ?&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> stmtOut.Close()</span><br><span class="line"></span><br><span class="line"><span class="comment">// 插入0-24个数字作为id到user表里。</span></span><br><span class="line"><span class="keyword">for</span> i := <span class="number">0</span>; i &lt; <span class="number">25</span>; i++ &#123;</span><br><span class="line">	_, err = stmtIns.Exec(i, <span class="string">&#x27;testname&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">    	<span class="built_in">panic</span>(err.Error())</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> username <span class="keyword">string</span></span><br><span class="line"><span class="comment">// 查询id是13的username</span></span><br><span class="line">err = stmtOut.QueryRow(<span class="number">13</span>).Scan(&amp;username)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br><span class="line">fmt.Printf(<span class="string">&quot;The username is: %s&quot;</span>, username)</span><br><span class="line"></span><br><span class="line"><span class="comment">// 删除数据</span></span><br><span class="line">stmtDel, err = db.Prepare(<span class="string">&quot;delete from user where id = ?&quot;</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">defer</span> stmtDel.Close()</span><br><span class="line">res, err = stmtDel.Exec(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br><span class="line">affect, err = res.RowsAffected()</span><br><span class="line"><span class="keyword">if</span> err != <span class="literal">nil</span> &#123;</span><br><span class="line">	<span class="built_in">panic</span>(err.Error())</span><br><span class="line">&#125;</span><br><span class="line">fmt.Println(affect)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这样就完成了几个最基本的增删改查的操作。非常的简单。<br>Prepare函数是不直接执行的，要等到调用Exec()函数才会真正执行操作。<br>下一篇会介绍基本的redis操作。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/02/Python-asyncio%E6%A8%A1%E5%9D%97%E8%AF%A6%E8%A7%A3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/02/Python-asyncio%E6%A8%A1%E5%9D%97%E8%AF%A6%E8%A7%A3/" class="post-title-link" itemprop="url">Python asyncio模块</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-02 22:37:00" itemprop="dateCreated datePublished" datetime="2018-04-02T22:37:00+08:00">2018-04-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Python/" itemprop="url" rel="index"><span itemprop="name">Python</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/02/Python-asyncio%E6%A8%A1%E5%9D%97%E8%AF%A6%E8%A7%A3/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/02/Python-asyncio%E6%A8%A1%E5%9D%97%E8%AF%A6%E8%A7%A3/" class="cy_cmt_count" data-xid="2018/04/02/Python-asyncio模块详解/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="asyncio模块"><a href="#asyncio模块" class="headerlink" title="asyncio模块"></a>asyncio模块</h2><h3 id="事件循环"><a href="#事件循环" class="headerlink" title="事件循环"></a>事件循环</h3><p>大多数异步应用程序实现异步的基本机制是通过在后台执行的事件循环。当有代码需要执行时，这些代码才会被注册到事件循环中。大多数程序都是依赖这个机制实现的，比如服务器，桌面程序，大多数视频游戏等。<br>一般情况下，我们不需要自己创建一个事件循环对象，只需要调用asyncio.get_event_loop()函数，返回一个BaseEventLoop对象即可。这个类帮你隐藏了细节，你不需要关心不同平台的区别。在所有平台上的API都是相同的，但是在某些平台上会有功能限制。</p>
<p>   要注意的是，当你第一次获得循环对象时，它还没有开始执行。</p>
   <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; loop &#x3D; asyncio.get_event_loop()</span><br><span class="line">&gt;&gt;&gt; loop.is_running()</span><br><span class="line">   False</span><br></pre></td></tr></table></figure>

<p>   1.执行循环</p>
<p>   2.注册任务并执行循环</p>
<p>   3.延迟调用</p>
<p>   4.偏函数</p>
<p>   5.任务结束前执行循环</p>
<p>   6.执行一个后台循环</p>
<h3 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h3><p>在asyncio中使用的大多数函数都是协程(coroutines)。协程是一种被设计用于在事件循环中执行的特殊函数。此外, 如果创建了协程但并未执行它，那么将会在日志中记录一个错误。3.6以下的版本可以使用@asyncio.coroutine装饰器，3.6以上可以使用async def xx 这样的新语法。一个简单的示例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">async</span> <span class="function"><span class="keyword">def</span> <span class="title">coro_sum</span>(<span class="params">*args</span>):</span></span><br><span class="line">    answer = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> args:</span><br><span class="line">        answer += <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> answer</span><br><span class="line">   </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(coro_sum(<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>))</span><br></pre></td></tr></table></figure>
<p>这样<em>coro_sum</em>函数就是一个协程，由事件循环来调用。此时已经不能再用常规方式调用这个函数了。<br>协程实际上是一个由事件循环消费的<strong>特殊生成器</strong></p>
<h4 id="嵌套的协程"><a href="#嵌套的协程" class="headerlink" title="嵌套的协程"></a>嵌套的协程</h4><p>协程提供了一种模仿顺序编程来调用其他协程的特殊机制，通过使用<em>await</em>关键字，一个协程可以执行另外一个协程，并由语句返回结果</p>
<h4 id="Future对象与Task对象"><a href="#Future对象与Task对象" class="headerlink" title="Future对象与Task对象"></a>Future对象与Task对象</h4><p>由于使用<em>asyncio</em>完成的大部分工作都是异步的，因此在处理以异步方式执行函数的返回值时必须小心。为此<em>await</em>关键字提供了一种处理方式。但是当希望并行执行异步函数的时候，就会需要一些别的处理方式。</p>
<h5 id="Future对象"><a href="#Future对象" class="headerlink" title="Future对象"></a>Future对象</h5><p><strong>Future</strong>是一个用于获取异步函数状态的对象，这包括函数的状态，比如函数是执行中，已完成，或者是已取消，还包括函数的返回值，或者是当函数引发异常时，返回对应的异常和回溯。</p>
<p><strong>Future</strong>是一个独立的对象，并不依赖正在执行的函数。该对象仅仅用于存储状态和结果信息，除此之外，并没有别的卵用。</p>
<h5 id="Task对象"><a href="#Task对象" class="headerlink" title="Task对象"></a>Task对象</h5><p><strong>Task</strong>对象是<strong>Future</strong>对象的子类，也是使用asyncio编程时最常用的对象，每当一个协程在事件循环中被安排执行后，协程就会被一个<strong>Task</strong>对象包装起来。因此，当你调用<em>run_until_complete</em>并传递一个协程时，该协程会被包装到一个<strong>Task</strong>对象中并执行，<strong>Task</strong>对象的任务是存储结果并为await语句提供值。</p>
<p><strong>run_until_complete</strong>方法并不是将一个协程包装到类中的唯一方式。完成这类工作的主要方式是使用<em>ensure_future</em>方法。</p>
<p>未完待续….</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="https://hawli.cn/2018/04/02/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-01/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="李科燃">
      <meta itemprop="description" content="早告别青春，活成了别人">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="李科燃的主页">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/04/02/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-01/" class="post-title-link" itemprop="url">Gin 系列教程 (01)-介绍</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-04-02 15:36:00" itemprop="dateCreated datePublished" datetime="2018-04-02T15:36:00+08:00">2018-04-02</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-07-22 23:18:37" itemprop="dateModified" datetime="2020-07-22T23:18:37+08:00">2020-07-22</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Golang/" itemprop="url" rel="index"><span itemprop="name">Golang</span></a>
                </span>
            </span>

          
  
  <span class="post-meta-item">
    
      <span class="post-meta-item-icon">
        <i class="far fa-comment"></i>
      </span>
      <span class="post-meta-item-text">Changyan: </span>
    
    
      <a title="changyan" href="/2018/04/02/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-01/#SOHUCS" itemprop="discussionUrl">
        <span id="url::https://hawli.cn/2018/04/02/Gin-%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-01/" class="cy_cmt_count" data-xid="2018/04/02/Gin-系列教程-01/" itemprop="commentCount"></span>
      </a>
    
  </span>
  
  

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近由于工作需要，需要把部分接口迁移到Go语言上，优化部分性能。经过一番考察后，我选择了<a target="_blank" rel="noopener" href="https://github.com/gin-gonic/gin">gin</a>这款轻量级的web框架，用来开发restful api。<br><img src="https://raw.githubusercontent.com/gin-gonic/logo/master/color.png"><br>首先看一下官方的介绍：</p>
<blockquote>
<p>Gin is a web framework written in Go (Golang). It features a martini-&gt; like API with much better performance, up to 40 times faster thanks &gt; to httprouter. If you need performance and good productivity, you &gt; will love Gin.</p>
</blockquote>
<p> 据说性能是martini的40倍，好吧，martini我也没接触过。</p>
<p> 然后看官方给出的一个例子：</p>
 <figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> main</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">main</span><span class="params">()</span></span> &#123;</span><br><span class="line">	r := gin.Default()</span><br><span class="line">	r.GET(<span class="string">&quot;/ping&quot;</span>, <span class="function"><span class="keyword">func</span><span class="params">(c *gin.Context)</span></span> &#123;</span><br><span class="line">		c.JSON(<span class="number">200</span>, gin.H&#123;</span><br><span class="line">			<span class="string">&quot;message&quot;</span>: <span class="string">&quot;pong&quot;</span>,</span><br><span class="line">		&#125;)</span><br><span class="line">	&#125;)</span><br><span class="line">	r.Run() <span class="comment">// listen and serve on 0.0.0.0:8080</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 然后运行这个例子， 默认是监听8080端口<br> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go run example.go</span><br></pre></td></tr></table></figure></p>
<h3 id="下载和安装"><a href="#下载和安装" class="headerlink" title="下载和安装"></a>下载和安装</h3> <figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get github.com/gin-gonic/gin</span><br></pre></td></tr></table></figure>
<p> 这里要提到一个小技巧，国内由于各种原因，导致go get 几乎处于不可用的状态，如果你有ss的话，可以使用<a target="_blank" rel="noopener" href="https://github.com/cyfdecyf/cow">cow</a>这个工具，把go get 的http请求转发给ss代理，这样在命令行里使用go get 就会比较顺畅了。</p>
<ul>
<li>import<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">&quot;github.com/gin-gonic/gin&quot;</span></span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="govendor"><a href="#govendor" class="headerlink" title="govendor"></a><a target="_blank" rel="noopener" href="https://github.com/kardianos/govendor">govendor</a></h3><p>也可以使用govendor这样的工具，来构建项目。</p>
<h5 id="1-安装govendor"><a href="#1-安装govendor" class="headerlink" title="1.安装govendor"></a>1.安装govendor</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go get github.com/kardianos/govendor</span><br></pre></td></tr></table></figure>

<h5 id="2-创建你的项目文件夹"><a href="#2-创建你的项目文件夹" class="headerlink" title="2.创建你的项目文件夹"></a>2.创建你的项目文件夹</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir -p <span class="variable">$GOPATH</span>/src/github.com/myusername/project &amp;&amp; <span class="built_in">cd</span> <span class="string">&quot;<span class="variable">$_</span>&quot;</span></span><br></pre></td></tr></table></figure>

<h5 id="3-初始化项目并安装gin"><a href="#3-初始化项目并安装gin" class="headerlink" title="3.初始化项目并安装gin"></a>3.初始化项目并安装gin</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ govendor init</span><br><span class="line">$ govendor fetch github.com/gin-gonic/gin@v1.2</span><br></pre></td></tr></table></figure>

<h5 id="4-复制初始模板到你的项目中"><a href="#4-复制初始模板到你的项目中" class="headerlink" title="4.复制初始模板到你的项目中"></a>4.复制初始模板到你的项目中</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ curl https://raw.githubusercontent.com/gin-gonic/gin/master/examples/basic/main.go &gt; main.go</span><br></pre></td></tr></table></figure>
<h5 id="5-运行你的项目"><a href="#5-运行你的项目" class="headerlink" title="5.运行你的项目"></a>5.运行你的项目</h5><figure class="highlight sh"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ go run main.go</span><br></pre></td></tr></table></figure>

<p>OK, 至此呢，一个简单的gin 项目的demo就跑起来了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">李科燃</p>
  <div class="site-description" itemprop="description">早告别青春，活成了别人</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">11</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hawkli-1994" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hawkli-1994" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">李科燃</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

  <script id="cy_cmt_num" src="https://changyan.sohu.com/upload/plugins/plugins.list.count.js?clientId=cyveItGXa"></script>


</body>
</html>
